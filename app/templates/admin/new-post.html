{% extends 'admin/base.html' %}
{% block page_content %}
	<div class="container shadow">
		<div class="page-header text-right">
			<h1>新增一篇{{ category.page_name }}</h1>
		</div>
		<form class="form">
			<div class="form-group">
				<label class="control-label" for="title">标题</label>
				<input type="text" class="form-control" placeholder="None"
					   name="title"/>
			</div>
			<div class="form-group">
				<label class="control-label" for="image">展示图</label>
				<div class="img-rounded thumbnail">
					<img src="{{ url_for('static', filename='image/default.jpg') }}"
						 alt="默认展示图" name="image" id="Preview" width="680"
						 height="340">
				</div>
				<input id="uploadImage" type="file" name="image_url"
					   accept="image/*"/>
				<p class="help-block">图片大小不要超过2M</p>
			</div>
		</form>
	</div>
{% endblock %}
{% block scripts %}
	{{ super() }}
	<script>
        $('#uploadImage').change(function () {
{#            var uploadUrl = Upload(this.files[0], "{{ url_for('main.upload') }}");#}
            var data = new FormData();
            data.append('File', this.files[0]);
            $.ajax({
                type: 'POST',
                url: "{{ url_for('main.upload') }}",
                data: data,
                dataType: 'json',
                contentType: false,
				processData:false,
				success: function (data) {
					$('#Preview').attr('src', data.data);
                },
				error: function () {
					console.log('错误')
                }
            });


        });
	</script>
{% endblock %}