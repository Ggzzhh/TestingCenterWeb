{% extends 'bootstrap/base.html' %}
{% block head %}
	{{ super() }}
	<link rel="stylesheet" href="{{ url_for('static', filename='css/community.css') }}" type="text/css">
	<style>
	</style>
{% endblock %}
{% block navbar %}
	<noscript unselectable="on" id="noscript">
		<div class="aw-404 aw-404-wrap container">
			<img src="http://wenda.bootcss.com/static/common/no-js.jpg">
			<p>你的浏览器禁用了JavaScript, 请开启后刷新浏览器获得更好的体验!</p>
		</div>
	</noscript>
	<div class="aw-top-menu-wrap">
		<div class="container">
			<!-- logo -->
			<div class="aw-logo hidden-xs">
				<a href="http://wenda.bootcss.com"></a>
			</div>
			<!-- end logo -->
			<!-- 搜索框 -->
			<div class="aw-search-box  hidden-xs hidden-sm">
				<form class="navbar-search" id="global_search_form" method="post">
					<input class="form-control search-query" type="text" placeholder="搜索问题、话题或人" autocomplete="off" name="q" id="aw-search-query">
					<span title="搜索" id="global_search_btns" onclick="$('#global_search_form').submit();"><i class="icon icon-search"></i></span>
					<div class="aw-dropdown" >
						<div class="mod-body">
							<p class="title">输入关键字进行搜索</p>
							<ul class="aw-dropdown-list hide"></ul>
							<p class="search"><span>搜索:</span><a onclick="$('#global_search_form').submit();"></a></p>
						</div>
						<div class="mod-footer">
							<a href="" onclick="$('#header_publish').click();" class="pull-right btn btn-mini btn-success publish">发起问题</a>
						</div>
					</div>
				</form>
			</div>
			<!-- end 搜索框 -->
			<!-- 导航 -->
			<div class="aw-top-nav navbar">
				<div class="navbar-header">
					<button class="navbar-toggle pull-left" data-toggle="collapse"
							id="navar-toggle"
							data-target="#navbar-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
				</div>
				<nav role="navigation" class="collapse navbar-collapse
				bs-navbar-collapse" id="navbar-collapse">
					<ul class="nav navbar-nav">
						<li><a href="" class="active"><i class="icon icon-ul"></i> 发现</a></li>
						<li><a href="http://wenda.bootcss.com/topic/"><i class="icon icon-topic"></i> 话题</a></li>
					</ul>
				</nav>
			</div>
			<!-- end 导航 -->
			<!-- 用户栏 -->
			<div class="aw-user-nav">
				<!-- 登陆&注册栏 -->
				<span>
						<a class="register btn btn-normal btn-success" href="http://wenda.bootcss.com/account/register/">注册</a>
						<a class="login btn btn-normal btn-primary" href="http://wenda.bootcss.com/login/">登录</a>
					</span>
				<!-- end 登陆&注册栏 -->
			</div>
			<!-- end 用户栏 -->
			<!-- 发起 -->
			<!-- end 发起 -->
		</div>
	</div>
{% endblock %}
{% block content %}
	<div class="container">
		论坛内容 | 活跃用户（最近回答问题以及发布文章的人）
	</div>
{% endblock %}
{% block scripts %}
	{{ super() }}
	<script>
        var csrf_token = "{{ csrf_token() }}";
        $.ajaxSetup({
            beforeSend: function(xhr, settings) {
                if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type)
                    && !this.crossDomain) {
                    xhr.setRequestHeader("X-CSRFToken", csrf_token);
                }
            }
        });

        var data = {'title': '标题', 'body': '内容'};
        // add_community_post(data);
        // show_community_post(1);
        // delete_community(2, 'comment');
		// update_community_post(data);
		// add_community_comment(data);


        function add_community_post(data) {
            if (data.title === undefined || data.title === "" || data.body ===
                undefined || data.body === ""){
                return
            }
            data = JSON.stringify(data);
            $.ajax({
                type: 'POST',
                url: "{{ url_for('api.add_community_post') }}",
                data: data,
                dataType: 'json',
                contentType: 'application/json;',
                success: function (data) {
                    console.log(data)
                }
            })
        }

        function delete_community(id, method) {
            var url;
            if (method === 'post'){
                url = "/api-v1.0/community-post/" + id
			}
			else if (method === 'comment'){
                url = "/api-v1.0/community-comment/" + id
			}
            $.ajax({
                type: 'DELETE',
                url: url,
                data: data,
                dataType: 'json',
                success: function (data) {
                    console.log(data)
                }
            })
        }

        function show_community_post(id) {
            $.ajax({
                type: 'GET',
                url: "/api-v1.0/community-post/" + id,
                data: data,
                dataType: 'json',
                success: function (data) {
                    console.log(data)
                }
            })
        }

        function update_community_post(data) {
            if (data.title === undefined || data.title === "" || data.body ===
                undefined || data.body === ""){
                return
            }
            data = JSON.stringify(data);
            $.ajax({
                type: 'POST',
                url: "{{ url_for('api.update_community_post', id=1) }}",
                data: data,
                dataType: 'json',
                contentType: 'application/json;',
                success: function (data) {
                    console.log(data)
                }
            })
        }

        function add_community_comment(data) {
			if (data.body === undefined || data.body === ""){
                return
            }
            data.post_id = 1; // 之后改为 { id }
			data = JSON.stringify(data);
            $.ajax({
                type: 'POST',
                url: "{{ url_for('api.add_community_comment') }}",
                data: data,
                dataType: 'json',
                contentType: 'application/json;',
                success: function (data) {
                    console.log(data)
                }
            })
        }
	</script>
{% endblock %}